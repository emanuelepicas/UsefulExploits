# Server-side request forgery

## Description

Server-side request forgery (also known as SSRF) is a web security vulnerability that allows an attacker 
to induce the server-side application to make requests to an unintended location.
In a typical SSRF attack, the attacker might cause the server to make a connection to internal-only services within 
the organization's infrastructure. In other cases, they may be able to force the server to connect to 
arbitrary external systems, potentially leaking sensitive data such as authorization credentials.

### Basic SSRF against the local server
```
change the URL in the stockApi parameter to http://localhost/admin. 
This should display the administration interface.
Read the HTML to identify the URL to delete the target user, which is:

http://localhost/admin/delete?username=carlos
```

### Basic SSRF against another back-end system

```
Click "Clear ยง", change the stockApi parameter to http://192.168.0.1:8080/admin then highlight 
the final octet of the IP address (the number 1), click "Add ยง".
Switch to the Payloads tab, change the payload type to Numbers, and enter 1, 255, and 1 in the 
"From" and "To" and "Step" boxes respectively.
Click "Start attack".
Click on the "Status" column to sort it by status code ascending. You should see a single entry 
with a status of 200, showing an admin interface.
```


### SSRF with blacklist-based input filter

```
Visit a product, click "Check stock", intercept the request in Burp Suite, and send it to Burp Repeater.
Change the URL in the stockApi parameter to http://127.0.0.1/ and observe that the request is blocked.
Bypass the block by changing the URL to: http://127.1/
Change the URL to http://127.1/admin and observe that the URL is blocked again.
Obfuscate the "a" by double-URL encoding it to %2561 (a) to access the admin interface and delete the target user.
```
### SSRF with filter bypass via open redirection vulnerability

```
Visit a product, click "Check stock", intercept the request in Burp Suite, and send it to Burp Repeater.
Try tampering with the stockApi parameter and observe that it isn't possible to make the server issue the request directly to a different host.
Click "next product" and observe that the path parameter is placed into the Location header of a redirection response, resulting in an open redirection.
Create a URL that exploits the open redirection vulnerability, and redirects to the admin interface, and feed this into the stockApi parameter on the stock checker:

/product/nextProduct?path=http://192.168.0.12:8080/admin
Observe that the stock checker follows the redirection and shows you the admin page.
Amend the path to delete the target user:

/product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=c
```
### Blind SSRF with out-of-band detection

```
Visit a product, intercept the request in Burp Suite, and send it to Burp Repeater.
Change the Referer header to use the generated Burp Collaborator domain in place of the original domain. Send the request.
Go back to the Burp Collaborator client window, and click "Poll now". If you don't see any interactions listed, wait a few seconds and try again, since the server-side command is executed asynchronously.
You should see some DNS and HTTP interactions that were initiated by the application as the result of your payload.
```
